<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bella Fascendini">
<meta name="dcterms.date" content="2025-04-24">

<title>Logistic Regression in Developmental Research: A Practical Tutorial – PSY504 Lab Assignments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PSY504 Lab Assignments</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/bellafascendini"> <i class="bi bi-fa-brands fa-github" role="img">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-why-logistic-regression-matters-in-developmental-research" id="toc-introduction-why-logistic-regression-matters-in-developmental-research" class="nav-link active" data-scroll-target="#introduction-why-logistic-regression-matters-in-developmental-research">1. Introduction: Why Logistic Regression Matters in Developmental Research</a>
  <ul class="collapse">
  <li><a href="#why-linear-regression-falls-short-for-binary-outcomes" id="toc-why-linear-regression-falls-short-for-binary-outcomes" class="nav-link" data-scroll-target="#why-linear-regression-falls-short-for-binary-outcomes">Why Linear Regression Falls Short for Binary Outcomes</a></li>
  </ul></li>
  <li><a href="#theoretical-foundations" id="toc-theoretical-foundations" class="nav-link" data-scroll-target="#theoretical-foundations">2. Theoretical Foundations</a>
  <ul class="collapse">
  <li><a href="#understanding-probability-odds-and-log-odds" id="toc-understanding-probability-odds-and-log-odds" class="nav-link" data-scroll-target="#understanding-probability-odds-and-log-odds">Understanding Probability, Odds, and Log Odds</a></li>
  <li><a href="#the-logistic-function" id="toc-the-logistic-function" class="nav-link" data-scroll-target="#the-logistic-function">The Logistic Function</a></li>
  <li><a href="#interpreting-coefficients-odds-ratios" id="toc-interpreting-coefficients-odds-ratios" class="nav-link" data-scroll-target="#interpreting-coefficients-odds-ratios">Interpreting Coefficients: Odds Ratios</a></li>
  <li><a href="#statistical-assumptions-of-logistic-regression" id="toc-statistical-assumptions-of-logistic-regression" class="nav-link" data-scroll-target="#statistical-assumptions-of-logistic-regression">Statistical Assumptions of Logistic Regression</a></li>
  </ul></li>
  <li><a href="#case-study-do-toddlers-explore-their-own-competence" id="toc-case-study-do-toddlers-explore-their-own-competence" class="nav-link" data-scroll-target="#case-study-do-toddlers-explore-their-own-competence">3. Case Study: Do Toddlers Explore Their Own Competence?</a>
  <ul class="collapse">
  <li><a href="#study-background" id="toc-study-background" class="nav-link" data-scroll-target="#study-background">Study Background</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics</a></li>
  </ul></li>
  <li><a href="#building-logistic-regression-models" id="toc-building-logistic-regression-models" class="nav-link" data-scroll-target="#building-logistic-regression-models">4. Building Logistic Regression Models</a>
  <ul class="collapse">
  <li><a href="#simple-logistic-regression-with-an-intercept-only" id="toc-simple-logistic-regression-with-an-intercept-only" class="nav-link" data-scroll-target="#simple-logistic-regression-with-an-intercept-only">Simple Logistic Regression with an Intercept Only</a></li>
  <li><a href="#adding-age-as-a-predictor-multiple-logistic-regression" id="toc-adding-age-as-a-predictor-multiple-logistic-regression" class="nav-link" data-scroll-target="#adding-age-as-a-predictor-multiple-logistic-regression">Adding Age as a Predictor (Multiple Logistic Regression)</a></li>
  </ul></li>
  <li><a href="#model-evaluation-and-selection" id="toc-model-evaluation-and-selection" class="nav-link" data-scroll-target="#model-evaluation-and-selection">5. Model Evaluation and Selection</a>
  <ul class="collapse">
  <li><a href="#assessing-model-fit-with-information-criteria" id="toc-assessing-model-fit-with-information-criteria" class="nav-link" data-scroll-target="#assessing-model-fit-with-information-criteria">Assessing Model Fit with Information Criteria</a></li>
  <li><a href="#comparing-nested-models-with-likelihood-ratio-tests" id="toc-comparing-nested-models-with-likelihood-ratio-tests" class="nav-link" data-scroll-target="#comparing-nested-models-with-likelihood-ratio-tests">Comparing Nested Models with Likelihood Ratio Tests</a></li>
  <li><a href="#classification-performance-with-roc-curves" id="toc-classification-performance-with-roc-curves" class="nav-link" data-scroll-target="#classification-performance-with-roc-curves">Classification Performance with ROC Curves</a></li>
  </ul></li>
  <li><a href="#visualizing-results" id="toc-visualizing-results" class="nav-link" data-scroll-target="#visualizing-results">6. Visualizing Results</a>
  <ul class="collapse">
  <li><a href="#plotting-intercept-only-model-model-1" id="toc-plotting-intercept-only-model-model-1" class="nav-link" data-scroll-target="#plotting-intercept-only-model-model-1">Plotting Intercept-Only Model (Model 1)</a></li>
  <li><a href="#plotting-predicted-probabilities-by-age" id="toc-plotting-predicted-probabilities-by-age" class="nav-link" data-scroll-target="#plotting-predicted-probabilities-by-age">Plotting Predicted Probabilities by Age</a></li>
  </ul></li>
  <li><a href="#extended-applications" id="toc-extended-applications" class="nav-link" data-scroll-target="#extended-applications">8. Extended Applications</a>
  <ul class="collapse">
  <li><a href="#mixed-effects-logistic-regression-for-nested-data" id="toc-mixed-effects-logistic-regression-for-nested-data" class="nav-link" data-scroll-target="#mixed-effects-logistic-regression-for-nested-data">Mixed-Effects Logistic Regression for Nested Data</a></li>
  <li><a href="#longitudinal-logistic-models" id="toc-longitudinal-logistic-models" class="nav-link" data-scroll-target="#longitudinal-logistic-models">Longitudinal Logistic Models</a></li>
  <li><a href="#handling-age-as-a-continuous-predictor" id="toc-handling-age-as-a-continuous-predictor" class="nav-link" data-scroll-target="#handling-age-as-a-continuous-predictor">Handling Age as a Continuous Predictor</a></li>
  </ul></li>
  <li><a href="#troubleshooting-common-issues" id="toc-troubleshooting-common-issues" class="nav-link" data-scroll-target="#troubleshooting-common-issues">9. Troubleshooting Common Issues</a>
  <ul class="collapse">
  <li><a href="#sample-size-considerations" id="toc-sample-size-considerations" class="nav-link" data-scroll-target="#sample-size-considerations">Sample Size Considerations</a></li>
  <li><a href="#multicollinearity" id="toc-multicollinearity" class="nav-link" data-scroll-target="#multicollinearity">Multicollinearity</a></li>
  </ul></li>
  <li><a href="#summary-and-best-practices" id="toc-summary-and-best-practices" class="nav-link" data-scroll-target="#summary-and-best-practices">10. Summary and Best Practices</a>
  <ul class="collapse">
  <li><a href="#when-to-use-alternatives-to-logistic-regression" id="toc-when-to-use-alternatives-to-logistic-regression" class="nav-link" data-scroll-target="#when-to-use-alternatives-to-logistic-regression">When to Use Alternatives to Logistic Regression</a></li>
  <li><a href="#checklist-for-reporting-logistic-regression" id="toc-checklist-for-reporting-logistic-regression" class="nav-link" data-scroll-target="#checklist-for-reporting-logistic-regression">Checklist for Reporting Logistic Regression</a></li>
  <li><a href="#final-thoughts" id="toc-final-thoughts" class="nav-link" data-scroll-target="#final-thoughts">Final Thoughts</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Logistic Regression in Developmental Research: A Practical Tutorial</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bella Fascendini </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 24, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction-why-logistic-regression-matters-in-developmental-research" class="level2">
<h2 class="anchored" data-anchor-id="introduction-why-logistic-regression-matters-in-developmental-research">1. Introduction: Why Logistic Regression Matters in Developmental Research</h2>
<p>Developmental researchers frequently encounter binary outcome variables in their studies: a child either passes or fails a task, exhibits a behavior or doesn’t, or demonstrates understanding or shows a lack of comprehension. When analyzing such binary outcomes, logistic regression has become an essential statistical method, which allows us to model the probability of a binary outcome as a function of one or more predictor variables, making it particularly useful for developmental research.</p>
<p>In this tutorial, we’ll work through an actual dataset from my own research (data available on OSF:https://osf.io/pj53f/) examining toddlers’ intrinsic motivation to explore their competence. This study is particularly well-suited for logistic regression analysis because the main outcome variable, which toy toddlers approach first during exploration, is binary.</p>
<section id="why-linear-regression-falls-short-for-binary-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="why-linear-regression-falls-short-for-binary-outcomes">Why Linear Regression Falls Short for Binary Outcomes</h3>
<p>Before diving into logistic regression, let’s understand why we need it in the first place. When working with binary outcomes (coded as 0 and 1), linear regression presents several problems:</p>
<ol type="1">
<li><p><strong>Unbounded predictions</strong>: Linear regression can predict values like -0.3 or 1.5, which doesn’t make sense when we’re working with probabilities that must be between 0 and 1.</p></li>
<li><p><strong>Assumption about normality</strong>: When outcomes can only be 0 or 1, the errors in the model can’t follow the normal bell-shaped distribution that linear regression assumes.</p></li>
<li><p><strong>Heteroscedasticity</strong>: The spread of errors changes systematically depending on the predictor values, violating a key assumption of linear regression.</p></li>
</ol>
<p>Logistic regression solves these problems by modeling the log odds of the outcome (rather than the outcome directly), ensuring predictions stay between 0 and 1, and appropriately accounting for the binomial distribution of errors.</p>
</section>
</section>
<section id="theoretical-foundations" class="level2">
<h2 class="anchored" data-anchor-id="theoretical-foundations">2. Theoretical Foundations</h2>
<section id="understanding-probability-odds-and-log-odds" class="level3">
<h3 class="anchored" data-anchor-id="understanding-probability-odds-and-log-odds">Understanding Probability, Odds, and Log Odds</h3>
<p>Logistic regression uses three related concepts to model binary outcomes:</p>
<ul>
<li><strong>Probability</strong>: The likelihood of an event occurring (ranges from 0 to 1)</li>
<li><strong>Odds</strong>: The ratio of the probability of success to the probability of failure (ranges from 0 to ∞)</li>
<li><strong>Log odds</strong>: The natural logarithm of the odds (ranges from -∞ to ∞)</li>
</ul>
<p>The relationships between these concepts are: - Odds = Probability / (1 - Probability) - Probability = Odds / (1 + Odds) - Log odds = ln(Odds) - Odds = e^(Log odds)</p>
</section>
<section id="the-logistic-function" class="level3">
<h3 class="anchored" data-anchor-id="the-logistic-function">The Logistic Function</h3>
<p>At the heart of logistic regression is the logistic function (also called the sigmoid function):</p>
<p><span class="math display">\[P(Y=1) = \frac{1}{1 + e^{-(β_0 + β_1X_1 + β_2X_2 + ... + β_pX_p)}}\]</span></p>
<p>This S-shaped curve transforms the linear predictor (β₀ + β₁X₁ + β₂X₂ + …) into a probability value between 0 and 1.</p>
<p>Let’s visualize the logistic function:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for the logistic curve</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the logistic curve</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Linear predictor (β₀ + β₁X₁ + β₂X₂ + ...)"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability of success P(Y = 1)"</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"The Logistic Function"</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">"As x → -∞, P(Y=1) → 0"</span>) <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">0.8</span>, <span class="at">label =</span> <span class="st">"As x → ∞, P(Y=1) → 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_project_files/figure-html/logistic-curve-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpreting-coefficients-odds-ratios" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-coefficients-odds-ratios">Interpreting Coefficients: Odds Ratios</h3>
<p>Unlike linear regression where coefficients represent changes in the outcome variable, logistic regression coefficients represent changes in the log odds. To make interpretation more intuitive, we often convert these to odds ratios by exponentiating the coefficients:</p>
<p>Odds Ratio = e^β</p>
<p>An odds ratio of 1 indicates no effect. Odds ratios greater than 1 indicate the odds of success increase when the predictor increases, while odds ratios less than 1 indicate the odds decrease.</p>
</section>
<section id="statistical-assumptions-of-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="statistical-assumptions-of-logistic-regression">Statistical Assumptions of Logistic Regression</h3>
<p>Logistic regression has fewer assumptions than linear regression: 1. Independence of observations (unless accounted for with mixed models) 2. Little or no multicollinearity among predictors 3. Linear relationship between predictors and log odds 4. Large sample size (rule of thumb: at least 10 cases per predictor)</p>
</section>
</section>
<section id="case-study-do-toddlers-explore-their-own-competence" class="level2">
<h2 class="anchored" data-anchor-id="case-study-do-toddlers-explore-their-own-competence">3. Case Study: Do Toddlers Explore Their Own Competence?</h2>
<p>Let’s analyze data from one of my projects investigating whether toddlers are intrinsically motivated to explore their own competence. The researchers adapted classic exploratory play paradigms to examine whether two-year-olds seek to resolve uncertainty about what they can do.</p>
<section id="study-background" class="level3">
<h3 class="anchored" data-anchor-id="study-background">Study Background</h3>
<p>In this study, 49 toddlers (ages 24-35 months) played with different pairs of toys alongside a parent. For each pair of toys:</p>
<ul>
<li><strong>Confounded condition</strong>: The parent guided the toddler’s hand while playing with one toy, providing ambiguous evidence about whether the child could operate the toy independently</li>
<li><strong>Unconfounded condition</strong>: The parent and child took turns playing with the other toy independently, providing clear evidence about the child’s ability</li>
</ul>
<p>The key question was: When given a chance to freely explore the toys on their own, which toy would toddlers approach first? If toddlers seek to resolve uncertainty about their own competence, they should be more likely to approach the confounded toy.</p>
</section>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">Data Preparation</h3>
<p>Let’s Let’s start by loading and exploring the dataset:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)      <span class="co"># For mixed-effects logistic regression</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)   <span class="co"># For plotting</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"case_study_data.csv"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  subject_id gender age counterbalance fine.motor gross.motor total toy_1
1          2      F  30       PL DI SZ          5           6    11     P
2          3      F  30       PL DI SZ          7           5    12     P
3          5      M  30       PL DI SZ          7           7    14     P
4          6      M  30       PL DI SZ          7           5    12     P
5          7      F  30       PL DI SZ          7           7    14     P
6          8      M  30       PL DI SZ          6           7    13     P
  toy_1_confounding toy_1_competence toy_1_help toy_1_time toy_2
1                 C                3          0         31     L
2                 C                3          0         26     L
3                 U                3          0         13     L
4                 U                3          0         89     L
5                 U                3          0         52     L
6                 U               NA         NA         NA     L
  toy_2_confounding toy_2_competence toy_2_help toy_2_time pair_1_first_pick
1                 U                1          1        137                 L
2                 U                3          0          7                 P
3                 C                3          0         14                 P
4                 C                3          0         40                 L
5                 C                3          0         29                 L
6                 C                3          0         31              &lt;NA&gt;
  pair_1_first_pick_confounding toy_1_time_pair_1 toy_2_time_pair_1 toy_3
1                             U               151                 0     D
2                             C               138               234     D
3                             U                52                40     D
4                             C               155                61     D
5                             C                19                32     D
6                          &lt;NA&gt;                NA                NA     D
  toy_3_confounding toy_3_competence toy_3_help toy_3_time toy_4
1                 U                1          1        113     I
2                 U                2          0          9     I
3                 C                3          0         11     I
4                 C                3          0         38     I
5                 C                3          0          9     I
6                 C                3          0         11     I
  toy_4_confounding toy_4_competence toy_4_help toy_4_time pair_2_first_pick
1                 C                3          0         92                 D
2                 C                1          0         76                 D
3                 U                3          1        175                 D
4                 U                2          0        125                 D
5                 U                1          1         32                 D
6                 U                1          0        183                 D
  pair_2_first_pick_confounding toy_1_time_pair_2 toy_2_time_pair_2 toy_5
1                             U                 0                 0     S
2                             U                34                54     S
3                             C                10                59     S
4                             C                60                 0  &lt;NA&gt;
5                             C                17                 0     S
6                             C                NA                NA     S
  toy_5_confounding toy_5_competence toy_5_help toy_5_time toy_6
1                 C                3          0        108     Z
2                 C                3          0         60     Z
3                 U                3          0         48     Z
4              &lt;NA&gt;               NA         NA         NA  &lt;NA&gt;
5                 U                2          0         10     Z
6                 U                2          0         48     Z
  toy_6_confounding toy_6_competence toy_6_help toy_6_time pair_3_first_pick
1                 U                1          1        175                 S
2                 U                3          1          5                 S
3                 C                3          0         15                 Z
4              &lt;NA&gt;               NA         NA         NA              &lt;NA&gt;
5                 C                3          0          9                 S
6                 C                3          0         75                 Z
  pair_3_first_pick_confounding toy_1_time_pair_3 toy_2_time_pair_3
1                             C                65                 0
2                             C                41                 2
3                             C                 7               110
4                          &lt;NA&gt;                NA                NA
5                             U                 5                20
6                             C                10                 0</code></pre>
</div>
</div>
<p>In this dataset: - <code>subject_id</code>: Unique identifier for each child - <code>age_in_months</code>: Age of the child in months - <code>toy_pair</code>: Which pair of toys the child played with - <code>approached_confounded</code>: Binary outcome variable (1 if child approached the confounded toy first, 0 if unconfounded)</p>
<p>Now that we’ve loaded the data, let’s prepare it for analysis. The raw dataset has information about three different toy pairs that each child interacted with. We need to restructure it to have one row per toy pair per child.</p>
</section>
<section id="descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h3>
<p>First, let’s examine the overall rates of approaching the confounded toy:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and reshape the data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>clean_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject_id, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         age,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         pair_1_first_pick_confounding,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         pair_2_first_pick_confounding,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         pair_3_first_pick_confounding) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"pair"</span>),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"pair"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"confounding"</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(confounding), confounding <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"U"</span>))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a binary outcome variable (1 = approached confounded toy first)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="ot">&lt;-</span> clean_data <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">approach_confounded =</span> confounding <span class="sc">==</span> <span class="st">"C"</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_centered =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>)[,<span class="dv">1</span>]  <span class="co"># Center age</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># View the prepared data</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(analysis_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  subject_id   age pair             confounding approach_confounded age_centered
       &lt;int&gt; &lt;int&gt; &lt;chr&gt;            &lt;chr&gt;       &lt;lgl&gt;                      &lt;dbl&gt;
1          2    30 pair_1_first_pi… U           FALSE                      0.626
2          2    30 pair_2_first_pi… U           FALSE                      0.626
3          2    30 pair_3_first_pi… C           TRUE                       0.626
4          3    30 pair_1_first_pi… C           TRUE                       0.626
5          3    30 pair_2_first_pi… U           FALSE                      0.626
6          3    30 pair_3_first_pi… C           TRUE                       0.626</code></pre>
</div>
</div>
<p>Let’s also look at the overall proportions of children approaching each type of toy:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate overall proportions</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>overall_proportions <span class="ot">&lt;-</span> clean_data <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">n</span>(),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">confounded =</span> <span class="fu">sum</span>(confounding <span class="sc">==</span> <span class="st">"C"</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">unconfounded =</span> <span class="fu">sum</span>(confounding <span class="sc">==</span> <span class="st">"U"</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_confounded =</span> confounded<span class="sc">/</span>total,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_unconfounded =</span> unconfounded<span class="sc">/</span>total</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Overall Proportions:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Overall Proportions:"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_proportions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  total confounded unconfounded prop_confounded prop_unconfounded
  &lt;int&gt;      &lt;int&gt;        &lt;int&gt;           &lt;dbl&gt;             &lt;dbl&gt;
1   139         86           53           0.619             0.381</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Binomial test against chance</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>binom_test <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> overall_proportions<span class="sc">$</span>confounded,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> overall_proportions<span class="sc">$</span>total,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fl">0.5</span>,  </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Binomial Test Results:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Binomial Test Results:"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Binomial test: observed proportion = "</span>, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(overall_proportions<span class="sc">$</span>prop_confounded, <span class="dv">3</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">", p = "</span>, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(binom_test<span class="sc">$</span>p.value, <span class="dv">3</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">", 95% CI ["</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(binom_test<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">", "</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(binom_test<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"]"</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Binomial test: observed proportion = 0.619, p = 0.006, 95% CI [0.533, 0.7]"</code></pre>
</div>
</div>
<p>This initial analysis shows that toddlers approached the confounded toy first in about 62% of trials, which is significantly different from chance (50%).</p>
</section>
</section>
<section id="building-logistic-regression-models" class="level2">
<h2 class="anchored" data-anchor-id="building-logistic-regression-models">4. Building Logistic Regression Models</h2>
<p>Now we’re ready to build our logistic regression models. Since each child completed multiple trials, we’ll use mixed-effects logistic regression to account for the non-independence of observations.</p>
<section id="simple-logistic-regression-with-an-intercept-only" class="level3">
<h3 class="anchored" data-anchor-id="simple-logistic-regression-with-an-intercept-only">Simple Logistic Regression with an Intercept Only</h3>
<p>Let’s start with a simple model that just estimates the overall tendency to approach the confounded toy:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple logistic regression model with just an intercept</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(approach_confounded <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject_id), </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> analysis_data)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: approach_confounded ~ 1 + (1 | subject_id)
   Data: analysis_data

      AIC       BIC    logLik -2*log(L)  df.resid 
    188.8     194.7     -92.4     184.8       137 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.274 -1.274  0.785  0.785  0.785 

Random effects:
 Groups     Name        Variance Std.Dev.
 subject_id (Intercept) 0        0       
Number of obs: 139, groups:  subject_id, 49

Fixed effects:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)   0.4841     0.1746   2.772  0.00557 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
optimizer (Nelder_Mead) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<p>In this model:</p>
<p>The formula ‘approach_confounded ~ 1 + (1|subject_id)’ specifies:</p>
<ul>
<li>approach_confounded is our binary outcome</li>
<li>~ 1 means we’re only estimating an intercept (no predictors)</li>
<li><ul>
<li>(1|subject_id) adds a random intercept for each subject to account for repeated measures</li>
</ul></li>
<li>family = binomial(link = “logit”) specifies that we’re using logistic regression</li>
</ul>
<p>The intercept coefficient represents the log odds of approaching the confounded toy. Let’s convert this to a probability and odds ratio:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the fixed effect (intercept)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fu">fixef</span>(model1)[<span class="dv">1</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert log odds to probability</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>probability <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>intercept))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Probability of approaching the confounded toy:"</span>, probability, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Probability of approaching the confounded toy: 0.618705 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to odds ratio</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>odds_ratio <span class="ot">&lt;-</span> <span class="fu">exp</span>(intercept)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odds ratio:"</span>, odds_ratio, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Odds ratio: 1.622642 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"This means the odds of approaching the confounded toy are"</span>, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(odds_ratio, <span class="dv">2</span>), <span class="st">"times higher than approaching the unconfounded toy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>This means the odds of approaching the confounded toy are 1.62 times higher than approaching the unconfounded toy</code></pre>
</div>
</div>
</section>
<section id="adding-age-as-a-predictor-multiple-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="adding-age-as-a-predictor-multiple-logistic-regression">Adding Age as a Predictor (Multiple Logistic Regression)</h3>
<p>Next, let’s add age as a predictor to see if older children are more or less likely to approach the confounded toy:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression model with age as predictor</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(approach_confounded <span class="sc">~</span> age_centered <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject_id), </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> analysis_data)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: approach_confounded ~ age_centered + (1 | subject_id)
   Data: analysis_data

      AIC       BIC    logLik -2*log(L)  df.resid 
    190.1     198.9     -92.0     184.1       136 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.4410 -1.2292  0.7262  0.7953  0.8910 

Random effects:
 Groups     Name        Variance Std.Dev.
 subject_id (Intercept) 0        0       
Number of obs: 139, groups:  subject_id, 49

Fixed effects:
             Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)   0.48656    0.17517   2.778  0.00547 **
age_centered -0.04544    0.05491  -0.827  0.40796   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
age_centerd -0.035
optimizer (Nelder_Mead) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<p>In this model, we included age as a continuous predictor. The coefficient for age represents the change in log odds of approaching the confounded toy for each additional month of age. The results reveal a significant tendency for toddlers to approach confounded toys first (β = 0.487, p &lt; 0.01), with the odds of selecting a confounded toy being 1.63 times higher than selecting an unconfounded toy. Interestingly, the age coefficient was negative but not statistically significant (β = -0.045, p = 0.408), suggesting that this motivation to explore one’s own competence remains relatively stable across the 24-35 month age range in our sample.</p>
<p>These findings support our hypothesis that toddlers seek out tasks to explore their own abilities, similar to how they explore to understand the physical world around them.</p>
</section>
</section>
<section id="model-evaluation-and-selection" class="level2">
<h2 class="anchored" data-anchor-id="model-evaluation-and-selection">5. Model Evaluation and Selection</h2>
<p>How do we know which model best explains our data? Let’s explore several methods for comparing our models.</p>
<section id="assessing-model-fit-with-information-criteria" class="level3">
<h3 class="anchored" data-anchor-id="assessing-model-fit-with-information-criteria">Assessing Model Fit with Information Criteria</h3>
<p>First, we can compare models using information criteria such as AIC (Akaike Information Criterion) and BIC (Bayesian Information Criterion):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models using AIC and BIC</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>aic_values <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model1, model2)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>bic_values <span class="ot">&lt;-</span> <span class="fu">BIC</span>(model1, model2)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Intercept Only"</span>, <span class="st">"Age"</span>),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> aic_values<span class="sc">$</span>AIC,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">BIC =</span> bic_values<span class="sc">$</span>BIC,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">logLik</span>(model1), <span class="st">"df"</span>), <span class="fu">attr</span>(<span class="fu">logLik</span>(model2), <span class="st">"df"</span>))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>comparison_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Model      AIC      BIC df
1 Intercept Only 188.7851 194.6540  2
2            Age 190.0969 198.9003  3</code></pre>
</div>
</div>
<p>Lower AIC and BIC values indicate better model fit, with a penalty for model complexity. The difference in AIC values can be interpreted as follows:</p>
<p>Difference of 0-2: Little support for difference between models Difference of 4-7: Moderate support for the model with lower AIC Difference &gt; 10: Strong support for the model with lower AIC</p>
<p>Looking at our results, the Intercept Only model has an AIC of 188.7851 while the Age model has an AIC of 190.0969, a difference of about 1.31. This small difference (&lt; 2) suggests there is little support for choosing the Intercept Only model over the Age model, despite it having a slightly lower AIC. The BIC values tell a similar story, with the Intercept Only model having a lower BIC (194.6540) compared to the Age model (198.9003), but the difference is still relatively small.</p>
<p>In a nutshell, adding age to the model did not improve the better.</p>
</section>
<section id="comparing-nested-models-with-likelihood-ratio-tests" class="level3">
<h3 class="anchored" data-anchor-id="comparing-nested-models-with-likelihood-ratio-tests">Comparing Nested Models with Likelihood Ratio Tests</h3>
<p>We can formally compare nested models using likelihood ratio tests:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test if adding age improves the model</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1, model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: analysis_data
Models:
model1: approach_confounded ~ 1 + (1 | subject_id)
model2: approach_confounded ~ age_centered + (1 | subject_id)
       npar    AIC    BIC  logLik -2*log(L)  Chisq Df Pr(&gt;Chisq)
model1    2 188.78 194.65 -92.393    184.78                     
model2    3 190.10 198.90 -92.048    184.10 0.6882  1     0.4068</code></pre>
</div>
</div>
<p>The test produces a chi-square statistic of 0.6882 with 1 degree of freedom (corresponding to the one additional parameter in model2). The p-value is 0.4068, which is not statistically significant (p &gt; 0.05)</p>
<p>This non-significant result indicates that adding age as a predictor does not significantly improve the model fit compared to the intercept-only model. In other words, the data does not provide strong evidence that a child’s age significantly predicts whether they will approach the confounded toy first.</p>
</section>
<section id="classification-performance-with-roc-curves" class="level3">
<h3 class="anchored" data-anchor-id="classification-performance-with-roc-curves">Classification Performance with ROC Curves</h3>
<p>ROC curves provide a visual way to evaluate classification performance across different thresholds. The Area Under the Curve (AUC) summarizes the overall discrimination ability of the model, with values closer to 1 indicating better performance:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate ROC curves for both models</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>roc1 <span class="ot">&lt;-</span> <span class="fu">roc</span>(analysis_data<span class="sc">$</span>approach_confounded, <span class="fu">fitted</span>(model1))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>roc2 <span class="ot">&lt;-</span> <span class="fu">roc</span>(analysis_data<span class="sc">$</span>approach_confounded, <span class="fu">fitted</span>(model2))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC curves</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc1, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">main =</span> <span class="st">"ROC Curves for Model Comparison"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate (1-Specificity)"</span>, </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate (Sensitivity)"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(roc2, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"Model 1 (Intercept Only), AUC ="</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc1), <span class="dv">3</span>)), </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste</span>(<span class="st">"Model 2 (Age), AUC ="</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc2), <span class="dv">3</span>))),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_project_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare AUC values</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model 1 AUC:"</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc1), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model 1 AUC: 0.5 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model 2 AUC:"</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc2), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model 2 AUC: 0.541 </code></pre>
</div>
</div>
<p>The graph shows the ROC curves for both models:</p>
<ul>
<li>The blue line represents Model 1 (Intercept Only)</li>
<li>The red line represents Model 2 (Age)</li>
</ul>
<p>Model 1 has an AUC of 0.5, which indicates it has no discriminative ability beyond random chance. This makes sense for an intercept-only model, as it assigns the same probability to all observations regardless of their characteristics. Model 2 has an AUC of 0.541, which is only marginally better than random chance (0.5). This slight improvement suggests that adding age as a predictor provides very minimal enhancement in classification performance.</p>
<p>This result is consistent with our AIC and BIC comparison, which also suggested that the additional complexity of including age as a predictor was not justified by a sufficient improvement in model fit.</p>
<p>When all of these model comparison methods point to the same conclusion, we can be more confident in our model selection decision.</p>
</section>
</section>
<section id="visualizing-results" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-results">6. Visualizing Results</h2>
<section id="plotting-intercept-only-model-model-1" class="level3">
<h3 class="anchored" data-anchor-id="plotting-intercept-only-model-model-1">Plotting Intercept-Only Model (Model 1)</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the fixed effect (intercept)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fu">fixef</span>(model1)[<span class="dv">1</span>]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert log odds to probability</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>probability <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>intercept))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple visualization of the intercept model</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>intercept_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="st">"Intercept Only"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probability =</span> probability</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add confidence interval</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract variance of random effect</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>random_effect_var <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">VarCorr</span>(model1))<span class="sc">$</span>vcov[<span class="dv">1</span>]</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standard error</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(random_effect_var)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% confidence interval</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)  <span class="co"># 1.96 for 95% CI</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>lower_ci <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>(intercept <span class="sc">-</span> z<span class="sc">*</span>se)))</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>upper_ci <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>(intercept <span class="sc">+</span> z<span class="sc">*</span>se)))</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to dataframe</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>intercept_data<span class="sc">$</span>lower_ci <span class="ot">&lt;-</span> lower_ci</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>intercept_data<span class="sc">$</span>upper_ci <span class="ot">&lt;-</span> upper_ci</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(intercept_data, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> Probability)) <span class="sc">+</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower_ci, <span class="at">ymax =</span> upper_ci), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkgray"</span>) <span class="sc">+</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Probability of Approaching Confounded Toy (Model 1)"</span>,</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Intercept-only model with 95% confidence interval"</span>,</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability"</span>,</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.8</span>, </span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Probability ="</span>, <span class="fu">round</span>(probability, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_project_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-predicted-probabilities-by-age" class="level3">
<h3 class="anchored" data-anchor-id="plotting-predicted-probabilities-by-age">Plotting Predicted Probabilities by Age</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with ages for prediction</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_centered =</span> <span class="fu">seq</span>(<span class="fu">min</span>(analysis_data<span class="sc">$</span>age_centered), </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">max</span>(analysis_data<span class="sc">$</span>age_centered), </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">subject_id =</span> <span class="cn">NA</span>  <span class="co"># Not used in prediction when re.form = NA</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predicted probabilities</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>predicted_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, <span class="at">newdata =</span> new_data, </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">re.form =</span> <span class="cn">NA</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert age centered back to actual age for plotting</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># First get the mean age from the original dataset</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(analysis_data<span class="sc">$</span>age)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>new_data<span class="sc">$</span>age_in_months <span class="ot">&lt;-</span> new_data<span class="sc">$</span>age_centered <span class="sc">+</span> mean_age</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(new_data, <span class="fu">aes</span>(<span class="at">x =</span> age_in_months, <span class="at">y =</span> predicted_prob)) <span class="sc">+</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age (months)"</span>, </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probability of Approaching Confounded Toy"</span>,</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Predicted Probability by Age"</span>) <span class="sc">+</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkgray"</span>) <span class="sc">+</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">24</span>, <span class="dv">36</span>, <span class="at">by =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="final_project_files/figure-html/plot-age-effect-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="extended-applications" class="level2">
<h2 class="anchored" data-anchor-id="extended-applications">8. Extended Applications</h2>
<p>For more complex developmental data, we may need more sophisticated models.</p>
<section id="mixed-effects-logistic-regression-for-nested-data" class="level3">
<h3 class="anchored" data-anchor-id="mixed-effects-logistic-regression-for-nested-data">Mixed-Effects Logistic Regression for Nested Data</h3>
<p>The models we’ve been using already incorporate random effects for subjects. We can extend this to include random slopes when we have strong theoretical reasons to believe that the effect of a predictor varies across participants:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random slopes model (if we had a time-varying predictor)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># model_random_slopes &lt;- glmer(approached_confounded ~ age_centered + </span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                             (1 + time|subject_id), </span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                             family = binomial(link = "logit"), </span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                             data = analysis_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="longitudinal-logistic-models" class="level3">
<h3 class="anchored" data-anchor-id="longitudinal-logistic-models">Longitudinal Logistic Models</h3>
<p>For longitudinal data, we can include time as a predictor and account for repeated measures:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Longitudinal model (if we had multiple time points)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># model_longitudinal &lt;- glmer(approached_confounded ~ age_centered * time + </span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                            (time|subject_id), </span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                            family = binomial(link = "logit"), </span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                            data = analysis_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="handling-age-as-a-continuous-predictor" class="level3">
<h3 class="anchored" data-anchor-id="handling-age-as-a-continuous-predictor">Handling Age as a Continuous Predictor</h3>
<p>When working with age, we might want to test for non-linear effects:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create squared age term</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>analysis_data<span class="sc">$</span>age_centered_squared <span class="ot">&lt;-</span> analysis_data<span class="sc">$</span>age_centered<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with quadratic age term</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>model_age_quadratic <span class="ot">&lt;-</span> <span class="fu">glmer</span>(approach_confounded <span class="sc">~</span> age_centered <span class="sc">+</span> </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                            age_centered_squared <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject_id), </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>), </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> analysis_data)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_age_quadratic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: approach_confounded ~ age_centered + age_centered_squared + (1 |  
    subject_id)
   Data: analysis_data

      AIC       BIC    logLik -2*log(L)  df.resid 
    191.1     202.8     -91.5     183.1       135 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.7421 -1.1682  0.7145  0.8270  0.8752 

Random effects:
 Groups     Name        Variance  Std.Dev. 
 subject_id (Intercept) 7.198e-16 2.683e-08
Number of obs: 139, groups:  subject_id, 49

Fixed effects:
                     Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)           0.29060    0.25865   1.124    0.261
age_centered         -0.04675    0.05637  -0.829    0.407
age_centered_squared  0.01968    0.01949   1.010    0.313

Correlation of Fixed Effects:
            (Intr) ag_cnt
age_centerd -0.006       
ag_cntrd_sq -0.733 -0.035
optimizer (Nelder_Mead) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</section>
</section>
<section id="troubleshooting-common-issues" class="level2">
<h2 class="anchored" data-anchor-id="troubleshooting-common-issues">9. Troubleshooting Common Issues</h2>
<section id="sample-size-considerations" class="level3">
<h3 class="anchored" data-anchor-id="sample-size-considerations">Sample Size Considerations</h3>
<p>A common rule of thumb is to have at least 10 events per predictor. We can check this:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check number of events (successes)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(analysis_data<span class="sc">$</span>approach_confounded)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check events per variable (EPV) for model2 (or another model that exists)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(analysis_data<span class="sc">$</span>approach_confounded) <span class="sc">/</span> <span class="fu">length</span>(<span class="fu">fixef</span>(model2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43</code></pre>
</div>
</div>
</section>
<section id="multicollinearity" class="level3">
<h3 class="anchored" data-anchor-id="multicollinearity">Multicollinearity</h3>
<p>Multicollinearity can be assessed with variance inflation factors (VIFs):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a linear model for VIF calculation</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.numeric</span>(approach_confounded) <span class="sc">~</span> age_centered, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> analysis_data)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate VIFs (requires car package)</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># car::vif(model_lm)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>VIF values above 5 or 10 indicate problematic multicollinearity.</p>
</section>
</section>
<section id="summary-and-best-practices" class="level2">
<h2 class="anchored" data-anchor-id="summary-and-best-practices">10. Summary and Best Practices</h2>
<section id="when-to-use-alternatives-to-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="when-to-use-alternatives-to-logistic-regression">When to Use Alternatives to Logistic Regression</h3>
<p>Consider alternatives when: - The outcome has more than two categories (use multinomial or ordinal logistic regression) - The data shows overdispersion (use quasi-binomial or negative binomial models) - The relationship between predictors and log odds is non-linear (use generalized additive models) - The sample size is very small (use exact logistic regression)</p>
</section>
<section id="checklist-for-reporting-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="checklist-for-reporting-logistic-regression">Checklist for Reporting Logistic Regression</h3>
<p>When reporting results: 1. Describe the model specification (fixed effects, random effects, link function) 2. Report coefficients and standard errors or confidence intervals 3. Include odds ratios for easier interpretation 4. Report model fit statistics (AIC, BIC, etc.) 5. Describe classification performance if relevant (accuracy, sensitivity, specificity) 6. Include visualizations of key effects 7. Discuss the findings in the context of developmental theory</p>
</section>
<section id="final-thoughts" class="level3">
<h3 class="anchored" data-anchor-id="final-thoughts">Final Thoughts</h3>
<p>Logistic regression is a powerful tool for analyzing binary outcomes in developmental research. By properly specifying models, carefully interpreting results, and effectively communicating findings, researchers can gain valuable insights into developmental processes.</p>
<p>The finding that toddlers systematically explore to discover their own competence has important implications for theories of intrinsic motivation and self-directed learning in early childhood. Understanding how children become aware of and test their own abilities can help parents and educators better support children’s natural curiosity and drive for mastery.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/bellafascendini\.github\.io\/PSY504-blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb44" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Logistic Regression in Developmental Research: A Practical Tutorial"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Bella Fascendini"</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co">    fig_height: 10</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co">    fig_width: 16</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="in">  warning = FALSE,</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="in">  message = FALSE,</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="in">  echo = TRUE,</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.width = 8,</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.height = 5</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. Introduction: Why Logistic Regression Matters in Developmental Research</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>Developmental researchers frequently encounter binary outcome variables</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>in their studies: a child either passes or fails a task, exhibits a</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>behavior or doesn't, or demonstrates understanding or shows a lack of</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>comprehension. When analyzing such binary outcomes, logistic regression</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>has become an essential statistical method, which allows us to model the</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>probability of a binary outcome as a function of one or more predictor</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>variables, making it particularly useful for developmental research.</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>In this tutorial, we'll work through an actual dataset from my own</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>research (data available on OSF:https://osf.io/pj53f/) examining</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>toddlers' intrinsic motivation to explore their competence. This study</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>is particularly well-suited for logistic regression analysis because the</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>main outcome variable, which toy toddlers approach first during</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>exploration, is binary.</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why Linear Regression Falls Short for Binary Outcomes</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>Before diving into logistic regression, let's understand why we need it</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>in the first place. When working with binary outcomes (coded as 0 and</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>1), linear regression presents several problems:</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Unbounded predictions**: Linear regression can predict values like</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>    -0.3 or 1.5, which doesn't make sense when we're working with</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>    probabilities that must be between 0 and 1.</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Assumption about normality**: When outcomes can only be 0 or 1,</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>    the errors in the model can't follow the normal bell-shaped</span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>    distribution that linear regression assumes.</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Heteroscedasticity**: The spread of errors changes systematically</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>    depending on the predictor values, violating a key assumption of</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>    linear regression.</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>Logistic regression solves these problems by modeling the log odds of</span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>the outcome (rather than the outcome directly), ensuring predictions</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>stay between 0 and 1, and appropriately accounting for the binomial</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>distribution of errors.</span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Theoretical Foundations</span></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a><span class="fu">### Understanding Probability, Odds, and Log Odds</span></span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a>Logistic regression uses three related concepts to model binary</span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>outcomes:</span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Probability**: The likelihood of an event occurring (ranges from 0</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>    to 1)</span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Odds**: The ratio of the probability of success to the probability</span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a>    of failure (ranges from 0 to ∞)</span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Log odds**: The natural logarithm of the odds (ranges from -∞ to</span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a>    ∞)</span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a>The relationships between these concepts are: - Odds = Probability /</span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a>(1 - Probability) - Probability = Odds / (1 + Odds) - Log odds =</span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>ln(Odds) - Odds = e\^(Log odds)</span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Logistic Function</span></span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a>At the heart of logistic regression is the logistic function (also</span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a>called the sigmoid function):</span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a>$$P(Y=1) = \frac{1}{1 + e^{-(β_0 + β_1X_1 + β_2X_2 + ... + β_pX_p)}}$$</span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a>This S-shaped curve transforms the linear predictor (β₀ + β₁X₁ + β₂X₂ +</span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a>...) into a probability value between 0 and 1.</span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a>Let's visualize the logistic function:</span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logistic-curve}</span></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a><span class="in"># Create data for the logistic curve</span></span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(-6, 6, length.out = 200)</span></span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a><span class="in">y &lt;- 1 / (1 + exp(-x))</span></span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot the logistic curve</span></span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data.frame(x = x, y = y), aes(x = x, y = y)) +</span></span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(color = "blue", size = 1) +</span></span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Linear predictor (β₀ + β₁X₁ + β₂X₂ + ...)",</span></span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Probability of success P(Y = 1)",</span></span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "The Logistic Function"</span></span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 0.5, linetype = "dashed", color = "gray") +</span></span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +</span></span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("text", x = -3, y = 0.2, label = "As x → -∞, P(Y=1) → 0") +</span></span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate("text", x = 3, y = 0.8, label = "As x → ∞, P(Y=1) → 1")</span></span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpreting Coefficients: Odds Ratios</span></span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a>Unlike linear regression where coefficients represent changes in the</span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a>outcome variable, logistic regression coefficients represent changes in</span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a>the log odds. To make interpretation more intuitive, we often convert</span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a>these to odds ratios by exponentiating the coefficients:</span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a>Odds Ratio = e\^β</span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a>An odds ratio of 1 indicates no effect. Odds ratios greater than 1</span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a>indicate the odds of success increase when the predictor increases,</span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a>while odds ratios less than 1 indicate the odds decrease.</span>
<span id="cb44-135"><a href="#cb44-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-136"><a href="#cb44-136" aria-hidden="true" tabindex="-1"></a><span class="fu">### Statistical Assumptions of Logistic Regression</span></span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a>Logistic regression has fewer assumptions than linear regression: 1.</span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a>Independence of observations (unless accounted for with mixed models) 2.</span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a>Little or no multicollinearity among predictors 3. Linear relationship</span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a>between predictors and log odds 4. Large sample size (rule of thumb: at</span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a>least 10 cases per predictor)</span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Case Study: Do Toddlers Explore Their Own Competence?</span></span>
<span id="cb44-145"><a href="#cb44-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a>Let's analyze data from one of my projects investigating whether</span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a>toddlers are intrinsically motivated to explore their own competence.</span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a>The researchers adapted classic exploratory play paradigms to examine</span>
<span id="cb44-149"><a href="#cb44-149" aria-hidden="true" tabindex="-1"></a>whether two-year-olds seek to resolve uncertainty about what they can</span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a>do.</span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a><span class="fu">### Study Background</span></span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a>In this study, 49 toddlers (ages 24-35 months) played with different</span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a>pairs of toys alongside a parent. For each pair of toys:</span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Confounded condition**: The parent guided the toddler's hand while</span>
<span id="cb44-158"><a href="#cb44-158" aria-hidden="true" tabindex="-1"></a>    playing with one toy, providing ambiguous evidence about whether the</span>
<span id="cb44-159"><a href="#cb44-159" aria-hidden="true" tabindex="-1"></a>    child could operate the toy independently</span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Unconfounded condition**: The parent and child took turns playing</span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a>    with the other toy independently, providing clear evidence about the</span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a>    child's ability</span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a>The key question was: When given a chance to freely explore the toys on</span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a>their own, which toy would toddlers approach first? If toddlers seek to</span>
<span id="cb44-166"><a href="#cb44-166" aria-hidden="true" tabindex="-1"></a>resolve uncertainty about their own competence, they should be more</span>
<span id="cb44-167"><a href="#cb44-167" aria-hidden="true" tabindex="-1"></a>likely to approach the confounded toy.</span>
<span id="cb44-168"><a href="#cb44-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Preparation</span></span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-171"><a href="#cb44-171" aria-hidden="true" tabindex="-1"></a>Let's Let's start by loading and exploring the dataset:</span>
<span id="cb44-172"><a href="#cb44-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-173"><a href="#cb44-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-data}</span></span>
<span id="cb44-174"><a href="#cb44-174" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a><span class="in">library(lme4)      # For mixed-effects logistic regression</span></span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)   # For plotting</span></span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a><span class="in"># Load data</span></span>
<span id="cb44-178"><a href="#cb44-178" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- read.csv("case_study_data.csv")</span></span>
<span id="cb44-179"><a href="#cb44-179" aria-hidden="true" tabindex="-1"></a><span class="in">head(data)</span></span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-182"><a href="#cb44-182" aria-hidden="true" tabindex="-1"></a>In this dataset: - <span class="in">`subject_id`</span>: Unique identifier for each child -</span>
<span id="cb44-183"><a href="#cb44-183" aria-hidden="true" tabindex="-1"></a><span class="in">`age_in_months`</span>: Age of the child in months - <span class="in">`toy_pair`</span>: Which pair of</span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a>toys the child played with - <span class="in">`approached_confounded`</span>: Binary outcome</span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a>variable (1 if child approached the confounded toy first, 0 if</span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a>unconfounded)</span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a>Now that we've loaded the data, let's prepare it for analysis. The raw</span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a>dataset has information about three different toy pairs that each child</span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a>interacted with. We need to restructure it to have one row per toy pair</span>
<span id="cb44-191"><a href="#cb44-191" aria-hidden="true" tabindex="-1"></a>per child.</span>
<span id="cb44-192"><a href="#cb44-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a><span class="fu">### Descriptive Statistics</span></span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a>First, let's examine the overall rates of approaching the confounded</span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a>toy:</span>
<span id="cb44-197"><a href="#cb44-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and reshape the data</span></span>
<span id="cb44-202"><a href="#cb44-202" aria-hidden="true" tabindex="-1"></a>clean_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb44-203"><a href="#cb44-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject_id, </span>
<span id="cb44-204"><a href="#cb44-204" aria-hidden="true" tabindex="-1"></a>         age,</span>
<span id="cb44-205"><a href="#cb44-205" aria-hidden="true" tabindex="-1"></a>         pair_1_first_pick_confounding,</span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a>         pair_2_first_pick_confounding,</span>
<span id="cb44-207"><a href="#cb44-207" aria-hidden="true" tabindex="-1"></a>         pair_3_first_pick_confounding) <span class="sc">%&gt;%</span></span>
<span id="cb44-208"><a href="#cb44-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"pair"</span>),</span>
<span id="cb44-210"><a href="#cb44-210" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"pair"</span>,</span>
<span id="cb44-211"><a href="#cb44-211" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"confounding"</span></span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(confounding), confounding <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"U"</span>))</span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a binary outcome variable (1 = approached confounded toy first)</span></span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a>analysis_data <span class="ot">&lt;-</span> clean_data <span class="sc">%&gt;%</span></span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">approach_confounded =</span> confounding <span class="sc">==</span> <span class="st">"C"</span>,</span>
<span id="cb44-219"><a href="#cb44-219" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_centered =</span> <span class="fu">scale</span>(age, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>)[,<span class="dv">1</span>]  <span class="co"># Center age</span></span>
<span id="cb44-220"><a href="#cb44-220" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a><span class="co"># View the prepared data</span></span>
<span id="cb44-223"><a href="#cb44-223" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(analysis_data)</span>
<span id="cb44-224"><a href="#cb44-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-225"><a href="#cb44-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-226"><a href="#cb44-226" aria-hidden="true" tabindex="-1"></a>Let's also look at the overall proportions of children approaching each</span>
<span id="cb44-227"><a href="#cb44-227" aria-hidden="true" tabindex="-1"></a>type of toy:</span>
<span id="cb44-228"><a href="#cb44-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-231"><a href="#cb44-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-232"><a href="#cb44-232" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate overall proportions</span></span>
<span id="cb44-233"><a href="#cb44-233" aria-hidden="true" tabindex="-1"></a>overall_proportions <span class="ot">&lt;-</span> clean_data <span class="sc">%&gt;%</span></span>
<span id="cb44-234"><a href="#cb44-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb44-235"><a href="#cb44-235" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">n</span>(),</span>
<span id="cb44-236"><a href="#cb44-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">confounded =</span> <span class="fu">sum</span>(confounding <span class="sc">==</span> <span class="st">"C"</span>),</span>
<span id="cb44-237"><a href="#cb44-237" aria-hidden="true" tabindex="-1"></a>    <span class="at">unconfounded =</span> <span class="fu">sum</span>(confounding <span class="sc">==</span> <span class="st">"U"</span>),</span>
<span id="cb44-238"><a href="#cb44-238" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_confounded =</span> confounded<span class="sc">/</span>total,</span>
<span id="cb44-239"><a href="#cb44-239" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_unconfounded =</span> unconfounded<span class="sc">/</span>total</span>
<span id="cb44-240"><a href="#cb44-240" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-241"><a href="#cb44-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-242"><a href="#cb44-242" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Overall Proportions:"</span>)</span>
<span id="cb44-243"><a href="#cb44-243" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_proportions)</span>
<span id="cb44-244"><a href="#cb44-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-245"><a href="#cb44-245" aria-hidden="true" tabindex="-1"></a><span class="co"># Binomial test against chance</span></span>
<span id="cb44-246"><a href="#cb44-246" aria-hidden="true" tabindex="-1"></a>binom_test <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(</span>
<span id="cb44-247"><a href="#cb44-247" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> overall_proportions<span class="sc">$</span>confounded,</span>
<span id="cb44-248"><a href="#cb44-248" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> overall_proportions<span class="sc">$</span>total,</span>
<span id="cb44-249"><a href="#cb44-249" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fl">0.5</span>,  </span>
<span id="cb44-250"><a href="#cb44-250" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb44-251"><a href="#cb44-251" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-252"><a href="#cb44-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-253"><a href="#cb44-253" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb44-254"><a href="#cb44-254" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Binomial Test Results:"</span>)</span>
<span id="cb44-255"><a href="#cb44-255" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(</span>
<span id="cb44-256"><a href="#cb44-256" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Binomial test: observed proportion = "</span>, </span>
<span id="cb44-257"><a href="#cb44-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(overall_proportions<span class="sc">$</span>prop_confounded, <span class="dv">3</span>),</span>
<span id="cb44-258"><a href="#cb44-258" aria-hidden="true" tabindex="-1"></a>  <span class="st">", p = "</span>, </span>
<span id="cb44-259"><a href="#cb44-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(binom_test<span class="sc">$</span>p.value, <span class="dv">3</span>),</span>
<span id="cb44-260"><a href="#cb44-260" aria-hidden="true" tabindex="-1"></a>  <span class="st">", 95% CI ["</span>,</span>
<span id="cb44-261"><a href="#cb44-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(binom_test<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb44-262"><a href="#cb44-262" aria-hidden="true" tabindex="-1"></a>  <span class="st">", "</span>,</span>
<span id="cb44-263"><a href="#cb44-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(binom_test<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb44-264"><a href="#cb44-264" aria-hidden="true" tabindex="-1"></a>  <span class="st">"]"</span></span>
<span id="cb44-265"><a href="#cb44-265" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb44-266"><a href="#cb44-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-267"><a href="#cb44-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-268"><a href="#cb44-268" aria-hidden="true" tabindex="-1"></a>This initial analysis shows that toddlers approached the confounded toy</span>
<span id="cb44-269"><a href="#cb44-269" aria-hidden="true" tabindex="-1"></a>first in about 62% of trials, which is significantly different from</span>
<span id="cb44-270"><a href="#cb44-270" aria-hidden="true" tabindex="-1"></a>chance (50%).</span>
<span id="cb44-271"><a href="#cb44-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-272"><a href="#cb44-272" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Building Logistic Regression Models</span></span>
<span id="cb44-273"><a href="#cb44-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-274"><a href="#cb44-274" aria-hidden="true" tabindex="-1"></a>Now we're ready to build our logistic regression models. Since each</span>
<span id="cb44-275"><a href="#cb44-275" aria-hidden="true" tabindex="-1"></a>child completed multiple trials, we'll use mixed-effects logistic</span>
<span id="cb44-276"><a href="#cb44-276" aria-hidden="true" tabindex="-1"></a>regression to account for the non-independence of observations.</span>
<span id="cb44-277"><a href="#cb44-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-278"><a href="#cb44-278" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simple Logistic Regression with an Intercept Only</span></span>
<span id="cb44-279"><a href="#cb44-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-280"><a href="#cb44-280" aria-hidden="true" tabindex="-1"></a>Let's start with a simple model that just estimates the overall tendency</span>
<span id="cb44-281"><a href="#cb44-281" aria-hidden="true" tabindex="-1"></a>to approach the confounded toy:</span>
<span id="cb44-282"><a href="#cb44-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-283"><a href="#cb44-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r model1}</span></span>
<span id="cb44-284"><a href="#cb44-284" aria-hidden="true" tabindex="-1"></a><span class="in"># Simple logistic regression model with just an intercept</span></span>
<span id="cb44-285"><a href="#cb44-285" aria-hidden="true" tabindex="-1"></a><span class="in">model1 &lt;- glmer(approach_confounded ~ 1 + (1|subject_id), </span></span>
<span id="cb44-286"><a href="#cb44-286" aria-hidden="true" tabindex="-1"></a><span class="in">                family = binomial(link = "logit"), </span></span>
<span id="cb44-287"><a href="#cb44-287" aria-hidden="true" tabindex="-1"></a><span class="in">                data = analysis_data)</span></span>
<span id="cb44-288"><a href="#cb44-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-289"><a href="#cb44-289" aria-hidden="true" tabindex="-1"></a><span class="in">summary(model1)</span></span>
<span id="cb44-290"><a href="#cb44-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-291"><a href="#cb44-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-292"><a href="#cb44-292" aria-hidden="true" tabindex="-1"></a>In this model:</span>
<span id="cb44-293"><a href="#cb44-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-294"><a href="#cb44-294" aria-hidden="true" tabindex="-1"></a>The formula ‘approach_confounded \~ 1 + (1\|subject_id)’ specifies:</span>
<span id="cb44-295"><a href="#cb44-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-296"><a href="#cb44-296" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>approach_confounded is our binary outcome</span>
<span id="cb44-297"><a href="#cb44-297" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>\~ 1 means we're only estimating an intercept (no predictors)</span>
<span id="cb44-298"><a href="#cb44-298" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span></span>
<span id="cb44-299"><a href="#cb44-299" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>(1\|subject_id) adds a random intercept for each subject to</span>
<span id="cb44-300"><a href="#cb44-300" aria-hidden="true" tabindex="-1"></a>        account for repeated measures</span>
<span id="cb44-301"><a href="#cb44-301" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>family = binomial(link = "logit") specifies that we're using</span>
<span id="cb44-302"><a href="#cb44-302" aria-hidden="true" tabindex="-1"></a>    logistic regression</span>
<span id="cb44-303"><a href="#cb44-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-304"><a href="#cb44-304" aria-hidden="true" tabindex="-1"></a>The intercept coefficient represents the log odds of approaching the</span>
<span id="cb44-305"><a href="#cb44-305" aria-hidden="true" tabindex="-1"></a>confounded toy. Let's convert this to a probability and odds ratio:</span>
<span id="cb44-306"><a href="#cb44-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-309"><a href="#cb44-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-310"><a href="#cb44-310" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the fixed effect (intercept)</span></span>
<span id="cb44-311"><a href="#cb44-311" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fu">fixef</span>(model1)[<span class="dv">1</span>]</span>
<span id="cb44-312"><a href="#cb44-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-313"><a href="#cb44-313" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert log odds to probability</span></span>
<span id="cb44-314"><a href="#cb44-314" aria-hidden="true" tabindex="-1"></a>probability <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>intercept))</span>
<span id="cb44-315"><a href="#cb44-315" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Probability of approaching the confounded toy:"</span>, probability, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb44-316"><a href="#cb44-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-317"><a href="#cb44-317" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to odds ratio</span></span>
<span id="cb44-318"><a href="#cb44-318" aria-hidden="true" tabindex="-1"></a>odds_ratio <span class="ot">&lt;-</span> <span class="fu">exp</span>(intercept)</span>
<span id="cb44-319"><a href="#cb44-319" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odds ratio:"</span>, odds_ratio, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb44-320"><a href="#cb44-320" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"This means the odds of approaching the confounded toy are"</span>, </span>
<span id="cb44-321"><a href="#cb44-321" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(odds_ratio, <span class="dv">2</span>), <span class="st">"times higher than approaching the unconfounded toy"</span>)</span>
<span id="cb44-322"><a href="#cb44-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-323"><a href="#cb44-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-324"><a href="#cb44-324" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding Age as a Predictor (Multiple Logistic Regression)</span></span>
<span id="cb44-325"><a href="#cb44-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-326"><a href="#cb44-326" aria-hidden="true" tabindex="-1"></a>Next, let's add age as a predictor to see if older children are more or</span>
<span id="cb44-327"><a href="#cb44-327" aria-hidden="true" tabindex="-1"></a>less likely to approach the confounded toy:</span>
<span id="cb44-328"><a href="#cb44-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-329"><a href="#cb44-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r model2}</span></span>
<span id="cb44-330"><a href="#cb44-330" aria-hidden="true" tabindex="-1"></a><span class="in"># Logistic regression model with age as predictor</span></span>
<span id="cb44-331"><a href="#cb44-331" aria-hidden="true" tabindex="-1"></a><span class="in">model2 &lt;- glmer(approach_confounded ~ age_centered + (1|subject_id), </span></span>
<span id="cb44-332"><a href="#cb44-332" aria-hidden="true" tabindex="-1"></a><span class="in">                family = binomial(link = "logit"), </span></span>
<span id="cb44-333"><a href="#cb44-333" aria-hidden="true" tabindex="-1"></a><span class="in">                data = analysis_data)</span></span>
<span id="cb44-334"><a href="#cb44-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-335"><a href="#cb44-335" aria-hidden="true" tabindex="-1"></a><span class="in">summary(model2)</span></span>
<span id="cb44-336"><a href="#cb44-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-337"><a href="#cb44-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-338"><a href="#cb44-338" aria-hidden="true" tabindex="-1"></a>In this model, we included age as a continuous predictor. The</span>
<span id="cb44-339"><a href="#cb44-339" aria-hidden="true" tabindex="-1"></a>coefficient for age represents the change in log odds of approaching the</span>
<span id="cb44-340"><a href="#cb44-340" aria-hidden="true" tabindex="-1"></a>confounded toy for each additional month of age. The results reveal a</span>
<span id="cb44-341"><a href="#cb44-341" aria-hidden="true" tabindex="-1"></a>significant tendency for toddlers to approach confounded toys first (β =</span>
<span id="cb44-342"><a href="#cb44-342" aria-hidden="true" tabindex="-1"></a>0.487, p <span class="sc">\&lt;</span> 0.01), with the odds of selecting a confounded toy being</span>
<span id="cb44-343"><a href="#cb44-343" aria-hidden="true" tabindex="-1"></a>1.63 times higher than selecting an unconfounded toy. Interestingly, the</span>
<span id="cb44-344"><a href="#cb44-344" aria-hidden="true" tabindex="-1"></a>age coefficient was negative but not statistically significant (β =</span>
<span id="cb44-345"><a href="#cb44-345" aria-hidden="true" tabindex="-1"></a>-0.045, p = 0.408), suggesting that this motivation to explore one's own</span>
<span id="cb44-346"><a href="#cb44-346" aria-hidden="true" tabindex="-1"></a>competence remains relatively stable across the 24-35 month age range in</span>
<span id="cb44-347"><a href="#cb44-347" aria-hidden="true" tabindex="-1"></a>our sample.</span>
<span id="cb44-348"><a href="#cb44-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-349"><a href="#cb44-349" aria-hidden="true" tabindex="-1"></a>These findings support our hypothesis that toddlers seek out tasks to</span>
<span id="cb44-350"><a href="#cb44-350" aria-hidden="true" tabindex="-1"></a>explore their own abilities, similar to how they explore to understand</span>
<span id="cb44-351"><a href="#cb44-351" aria-hidden="true" tabindex="-1"></a>the physical world around them.</span>
<span id="cb44-352"><a href="#cb44-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-353"><a href="#cb44-353" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5. Model Evaluation and Selection</span></span>
<span id="cb44-354"><a href="#cb44-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-355"><a href="#cb44-355" aria-hidden="true" tabindex="-1"></a>How do we know which model best explains our data? Let's explore several</span>
<span id="cb44-356"><a href="#cb44-356" aria-hidden="true" tabindex="-1"></a>methods for comparing our models.</span>
<span id="cb44-357"><a href="#cb44-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-358"><a href="#cb44-358" aria-hidden="true" tabindex="-1"></a><span class="fu">### Assessing Model Fit with Information Criteria</span></span>
<span id="cb44-359"><a href="#cb44-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-360"><a href="#cb44-360" aria-hidden="true" tabindex="-1"></a>First, we can compare models using information criteria such as AIC</span>
<span id="cb44-361"><a href="#cb44-361" aria-hidden="true" tabindex="-1"></a>(Akaike Information Criterion) and BIC (Bayesian Information Criterion):</span>
<span id="cb44-362"><a href="#cb44-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-365"><a href="#cb44-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-366"><a href="#cb44-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models using AIC and BIC</span></span>
<span id="cb44-367"><a href="#cb44-367" aria-hidden="true" tabindex="-1"></a>aic_values <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model1, model2)</span>
<span id="cb44-368"><a href="#cb44-368" aria-hidden="true" tabindex="-1"></a>bic_values <span class="ot">&lt;-</span> <span class="fu">BIC</span>(model1, model2)</span>
<span id="cb44-369"><a href="#cb44-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-370"><a href="#cb44-370" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-371"><a href="#cb44-371" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Intercept Only"</span>, <span class="st">"Age"</span>),</span>
<span id="cb44-372"><a href="#cb44-372" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> aic_values<span class="sc">$</span>AIC,</span>
<span id="cb44-373"><a href="#cb44-373" aria-hidden="true" tabindex="-1"></a>  <span class="at">BIC =</span> bic_values<span class="sc">$</span>BIC,</span>
<span id="cb44-374"><a href="#cb44-374" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="fu">c</span>(<span class="fu">attr</span>(<span class="fu">logLik</span>(model1), <span class="st">"df"</span>), <span class="fu">attr</span>(<span class="fu">logLik</span>(model2), <span class="st">"df"</span>))</span>
<span id="cb44-375"><a href="#cb44-375" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-376"><a href="#cb44-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-377"><a href="#cb44-377" aria-hidden="true" tabindex="-1"></a>comparison_df</span>
<span id="cb44-378"><a href="#cb44-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-379"><a href="#cb44-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-380"><a href="#cb44-380" aria-hidden="true" tabindex="-1"></a>Lower AIC and BIC values indicate better model fit, with a penalty for</span>
<span id="cb44-381"><a href="#cb44-381" aria-hidden="true" tabindex="-1"></a>model complexity. The difference in AIC values can be interpreted as</span>
<span id="cb44-382"><a href="#cb44-382" aria-hidden="true" tabindex="-1"></a>follows:</span>
<span id="cb44-383"><a href="#cb44-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-384"><a href="#cb44-384" aria-hidden="true" tabindex="-1"></a>Difference of 0-2: Little support for difference between models</span>
<span id="cb44-385"><a href="#cb44-385" aria-hidden="true" tabindex="-1"></a>Difference of 4-7: Moderate support for the model with lower AIC</span>
<span id="cb44-386"><a href="#cb44-386" aria-hidden="true" tabindex="-1"></a>Difference <span class="sc">\&gt;</span> 10: Strong support for the model with lower AIC</span>
<span id="cb44-387"><a href="#cb44-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-388"><a href="#cb44-388" aria-hidden="true" tabindex="-1"></a>Looking at our results, the Intercept Only model has an AIC of 188.7851</span>
<span id="cb44-389"><a href="#cb44-389" aria-hidden="true" tabindex="-1"></a>while the Age model has an AIC of 190.0969, a difference of about 1.31.</span>
<span id="cb44-390"><a href="#cb44-390" aria-hidden="true" tabindex="-1"></a>This small difference (<span class="sc">\&lt;</span> 2) suggests there is little support for</span>
<span id="cb44-391"><a href="#cb44-391" aria-hidden="true" tabindex="-1"></a>choosing the Intercept Only model over the Age model, despite it having</span>
<span id="cb44-392"><a href="#cb44-392" aria-hidden="true" tabindex="-1"></a>a slightly lower AIC. The BIC values tell a similar story, with the</span>
<span id="cb44-393"><a href="#cb44-393" aria-hidden="true" tabindex="-1"></a>Intercept Only model having a lower BIC (194.6540) compared to the Age</span>
<span id="cb44-394"><a href="#cb44-394" aria-hidden="true" tabindex="-1"></a>model (198.9003), but the difference is still relatively small.</span>
<span id="cb44-395"><a href="#cb44-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-396"><a href="#cb44-396" aria-hidden="true" tabindex="-1"></a>In a nutshell, adding age to the model did not improve the better.</span>
<span id="cb44-397"><a href="#cb44-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-398"><a href="#cb44-398" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing Nested Models with Likelihood Ratio Tests</span></span>
<span id="cb44-399"><a href="#cb44-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-400"><a href="#cb44-400" aria-hidden="true" tabindex="-1"></a>We can formally compare nested models using likelihood ratio tests:</span>
<span id="cb44-401"><a href="#cb44-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-402"><a href="#cb44-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r compare-models}</span></span>
<span id="cb44-403"><a href="#cb44-403" aria-hidden="true" tabindex="-1"></a><span class="in"># Test if adding age improves the model</span></span>
<span id="cb44-404"><a href="#cb44-404" aria-hidden="true" tabindex="-1"></a><span class="in">anova(model1, model2)</span></span>
<span id="cb44-405"><a href="#cb44-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-406"><a href="#cb44-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-407"><a href="#cb44-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-408"><a href="#cb44-408" aria-hidden="true" tabindex="-1"></a>The test produces a chi-square statistic of 0.6882 with 1 degree of</span>
<span id="cb44-409"><a href="#cb44-409" aria-hidden="true" tabindex="-1"></a>freedom (corresponding to the one additional parameter in model2). The</span>
<span id="cb44-410"><a href="#cb44-410" aria-hidden="true" tabindex="-1"></a>p-value is 0.4068, which is not statistically significant (p <span class="sc">\&gt;</span> 0.05)</span>
<span id="cb44-411"><a href="#cb44-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-412"><a href="#cb44-412" aria-hidden="true" tabindex="-1"></a>This non-significant result indicates that adding age as a predictor</span>
<span id="cb44-413"><a href="#cb44-413" aria-hidden="true" tabindex="-1"></a>does not significantly improve the model fit compared to the</span>
<span id="cb44-414"><a href="#cb44-414" aria-hidden="true" tabindex="-1"></a>intercept-only model. In other words, the data does not provide strong</span>
<span id="cb44-415"><a href="#cb44-415" aria-hidden="true" tabindex="-1"></a>evidence that a child's age significantly predicts whether they will</span>
<span id="cb44-416"><a href="#cb44-416" aria-hidden="true" tabindex="-1"></a>approach the confounded toy first.</span>
<span id="cb44-417"><a href="#cb44-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-418"><a href="#cb44-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### Classification Performance with ROC Curves</span></span>
<span id="cb44-419"><a href="#cb44-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-420"><a href="#cb44-420" aria-hidden="true" tabindex="-1"></a>ROC curves provide a visual way to evaluate classification performance</span>
<span id="cb44-421"><a href="#cb44-421" aria-hidden="true" tabindex="-1"></a>across different thresholds. The Area Under the Curve (AUC) summarizes</span>
<span id="cb44-422"><a href="#cb44-422" aria-hidden="true" tabindex="-1"></a>the overall discrimination ability of the model, with values closer to 1</span>
<span id="cb44-423"><a href="#cb44-423" aria-hidden="true" tabindex="-1"></a>indicating better performance:</span>
<span id="cb44-424"><a href="#cb44-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-427"><a href="#cb44-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-428"><a href="#cb44-428" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate ROC curves for both models</span></span>
<span id="cb44-429"><a href="#cb44-429" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb44-430"><a href="#cb44-430" aria-hidden="true" tabindex="-1"></a>roc1 <span class="ot">&lt;-</span> <span class="fu">roc</span>(analysis_data<span class="sc">$</span>approach_confounded, <span class="fu">fitted</span>(model1))</span>
<span id="cb44-431"><a href="#cb44-431" aria-hidden="true" tabindex="-1"></a>roc2 <span class="ot">&lt;-</span> <span class="fu">roc</span>(analysis_data<span class="sc">$</span>approach_confounded, <span class="fu">fitted</span>(model2))</span>
<span id="cb44-432"><a href="#cb44-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-433"><a href="#cb44-433" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC curves</span></span>
<span id="cb44-434"><a href="#cb44-434" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc1, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">main =</span> <span class="st">"ROC Curves for Model Comparison"</span>,</span>
<span id="cb44-435"><a href="#cb44-435" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate (1-Specificity)"</span>, </span>
<span id="cb44-436"><a href="#cb44-436" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True Positive Rate (Sensitivity)"</span>)</span>
<span id="cb44-437"><a href="#cb44-437" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(roc2, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb44-438"><a href="#cb44-438" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, </span>
<span id="cb44-439"><a href="#cb44-439" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"Model 1 (Intercept Only), AUC ="</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc1), <span class="dv">3</span>)), </span>
<span id="cb44-440"><a href="#cb44-440" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">paste</span>(<span class="st">"Model 2 (Age), AUC ="</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc2), <span class="dv">3</span>))),</span>
<span id="cb44-441"><a href="#cb44-441" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb44-442"><a href="#cb44-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-443"><a href="#cb44-443" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare AUC values</span></span>
<span id="cb44-444"><a href="#cb44-444" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model 1 AUC:"</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc1), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb44-445"><a href="#cb44-445" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model 2 AUC:"</span>, <span class="fu">round</span>(<span class="fu">auc</span>(roc2), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb44-446"><a href="#cb44-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-447"><a href="#cb44-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-448"><a href="#cb44-448" aria-hidden="true" tabindex="-1"></a>The graph shows the ROC curves for both models:</span>
<span id="cb44-449"><a href="#cb44-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-450"><a href="#cb44-450" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The blue line represents Model 1 (Intercept Only)</span>
<span id="cb44-451"><a href="#cb44-451" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The red line represents Model 2 (Age)</span>
<span id="cb44-452"><a href="#cb44-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-453"><a href="#cb44-453" aria-hidden="true" tabindex="-1"></a>Model 1 has an AUC of 0.5, which indicates it has no discriminative</span>
<span id="cb44-454"><a href="#cb44-454" aria-hidden="true" tabindex="-1"></a>ability beyond random chance. This makes sense for an intercept-only</span>
<span id="cb44-455"><a href="#cb44-455" aria-hidden="true" tabindex="-1"></a>model, as it assigns the same probability to all observations regardless</span>
<span id="cb44-456"><a href="#cb44-456" aria-hidden="true" tabindex="-1"></a>of their characteristics. Model 2 has an AUC of 0.541, which is only</span>
<span id="cb44-457"><a href="#cb44-457" aria-hidden="true" tabindex="-1"></a>marginally better than random chance (0.5). This slight improvement</span>
<span id="cb44-458"><a href="#cb44-458" aria-hidden="true" tabindex="-1"></a>suggests that adding age as a predictor provides very minimal</span>
<span id="cb44-459"><a href="#cb44-459" aria-hidden="true" tabindex="-1"></a>enhancement in classification performance.</span>
<span id="cb44-460"><a href="#cb44-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-461"><a href="#cb44-461" aria-hidden="true" tabindex="-1"></a>This result is consistent with our AIC and BIC comparison, which also</span>
<span id="cb44-462"><a href="#cb44-462" aria-hidden="true" tabindex="-1"></a>suggested that the additional complexity of including age as a predictor</span>
<span id="cb44-463"><a href="#cb44-463" aria-hidden="true" tabindex="-1"></a>was not justified by a sufficient improvement in model fit.</span>
<span id="cb44-464"><a href="#cb44-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-465"><a href="#cb44-465" aria-hidden="true" tabindex="-1"></a>When all of these model comparison methods point to the same conclusion,</span>
<span id="cb44-466"><a href="#cb44-466" aria-hidden="true" tabindex="-1"></a>we can be more confident in our model selection decision.</span>
<span id="cb44-467"><a href="#cb44-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-468"><a href="#cb44-468" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6. Visualizing Results</span></span>
<span id="cb44-469"><a href="#cb44-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-470"><a href="#cb44-470" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plotting Intercept-Only Model (Model 1)</span></span>
<span id="cb44-471"><a href="#cb44-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-474"><a href="#cb44-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-475"><a href="#cb44-475" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the fixed effect (intercept)</span></span>
<span id="cb44-476"><a href="#cb44-476" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fu">fixef</span>(model1)[<span class="dv">1</span>]</span>
<span id="cb44-477"><a href="#cb44-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-478"><a href="#cb44-478" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert log odds to probability</span></span>
<span id="cb44-479"><a href="#cb44-479" aria-hidden="true" tabindex="-1"></a>probability <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>intercept))</span>
<span id="cb44-480"><a href="#cb44-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-481"><a href="#cb44-481" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple visualization of the intercept model</span></span>
<span id="cb44-482"><a href="#cb44-482" aria-hidden="true" tabindex="-1"></a>intercept_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-483"><a href="#cb44-483" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="st">"Intercept Only"</span>,</span>
<span id="cb44-484"><a href="#cb44-484" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probability =</span> probability</span>
<span id="cb44-485"><a href="#cb44-485" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-486"><a href="#cb44-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-487"><a href="#cb44-487" aria-hidden="true" tabindex="-1"></a><span class="co"># Add confidence interval</span></span>
<span id="cb44-488"><a href="#cb44-488" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract variance of random effect</span></span>
<span id="cb44-489"><a href="#cb44-489" aria-hidden="true" tabindex="-1"></a>random_effect_var <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">VarCorr</span>(model1))<span class="sc">$</span>vcov[<span class="dv">1</span>]</span>
<span id="cb44-490"><a href="#cb44-490" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standard error</span></span>
<span id="cb44-491"><a href="#cb44-491" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(random_effect_var)</span>
<span id="cb44-492"><a href="#cb44-492" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate 95% confidence interval</span></span>
<span id="cb44-493"><a href="#cb44-493" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)  <span class="co"># 1.96 for 95% CI</span></span>
<span id="cb44-494"><a href="#cb44-494" aria-hidden="true" tabindex="-1"></a>lower_ci <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>(intercept <span class="sc">-</span> z<span class="sc">*</span>se)))</span>
<span id="cb44-495"><a href="#cb44-495" aria-hidden="true" tabindex="-1"></a>upper_ci <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>(intercept <span class="sc">+</span> z<span class="sc">*</span>se)))</span>
<span id="cb44-496"><a href="#cb44-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-497"><a href="#cb44-497" aria-hidden="true" tabindex="-1"></a><span class="co"># Add to dataframe</span></span>
<span id="cb44-498"><a href="#cb44-498" aria-hidden="true" tabindex="-1"></a>intercept_data<span class="sc">$</span>lower_ci <span class="ot">&lt;-</span> lower_ci</span>
<span id="cb44-499"><a href="#cb44-499" aria-hidden="true" tabindex="-1"></a>intercept_data<span class="sc">$</span>upper_ci <span class="ot">&lt;-</span> upper_ci</span>
<span id="cb44-500"><a href="#cb44-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-501"><a href="#cb44-501" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb44-502"><a href="#cb44-502" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(intercept_data, <span class="fu">aes</span>(<span class="at">x =</span> Model, <span class="at">y =</span> Probability)) <span class="sc">+</span></span>
<span id="cb44-503"><a href="#cb44-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb44-504"><a href="#cb44-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower_ci, <span class="at">ymax =</span> upper_ci), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb44-505"><a href="#cb44-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkgray"</span>) <span class="sc">+</span></span>
<span id="cb44-506"><a href="#cb44-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-507"><a href="#cb44-507" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Probability of Approaching Confounded Toy (Model 1)"</span>,</span>
<span id="cb44-508"><a href="#cb44-508" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Intercept-only model with 95% confidence interval"</span>,</span>
<span id="cb44-509"><a href="#cb44-509" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Probability"</span>,</span>
<span id="cb44-510"><a href="#cb44-510" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span></span>
<span id="cb44-511"><a href="#cb44-511" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-512"><a href="#cb44-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-513"><a href="#cb44-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-514"><a href="#cb44-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.8</span>, </span>
<span id="cb44-515"><a href="#cb44-515" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Probability ="</span>, <span class="fu">round</span>(probability, <span class="dv">2</span>)))</span>
<span id="cb44-516"><a href="#cb44-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-517"><a href="#cb44-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-518"><a href="#cb44-518" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plotting Predicted Probabilities by Age</span></span>
<span id="cb44-519"><a href="#cb44-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-520"><a href="#cb44-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-age-effect}</span></span>
<span id="cb44-521"><a href="#cb44-521" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a data frame with ages for prediction</span></span>
<span id="cb44-522"><a href="#cb44-522" aria-hidden="true" tabindex="-1"></a><span class="in">new_data &lt;- data.frame(</span></span>
<span id="cb44-523"><a href="#cb44-523" aria-hidden="true" tabindex="-1"></a><span class="in">  age_centered = seq(min(analysis_data$age_centered), </span></span>
<span id="cb44-524"><a href="#cb44-524" aria-hidden="true" tabindex="-1"></a><span class="in">                    max(analysis_data$age_centered), </span></span>
<span id="cb44-525"><a href="#cb44-525" aria-hidden="true" tabindex="-1"></a><span class="in">                    length.out = 100),</span></span>
<span id="cb44-526"><a href="#cb44-526" aria-hidden="true" tabindex="-1"></a><span class="in">  subject_id = NA  # Not used in prediction when re.form = NA</span></span>
<span id="cb44-527"><a href="#cb44-527" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb44-528"><a href="#cb44-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-529"><a href="#cb44-529" aria-hidden="true" tabindex="-1"></a><span class="in"># Add predicted probabilities</span></span>
<span id="cb44-530"><a href="#cb44-530" aria-hidden="true" tabindex="-1"></a><span class="in">new_data$predicted_prob &lt;- predict(model2, newdata = new_data, </span></span>
<span id="cb44-531"><a href="#cb44-531" aria-hidden="true" tabindex="-1"></a><span class="in">                                 re.form = NA, type = "response")</span></span>
<span id="cb44-532"><a href="#cb44-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-533"><a href="#cb44-533" aria-hidden="true" tabindex="-1"></a><span class="in"># Convert age centered back to actual age for plotting</span></span>
<span id="cb44-534"><a href="#cb44-534" aria-hidden="true" tabindex="-1"></a><span class="in"># First get the mean age from the original dataset</span></span>
<span id="cb44-535"><a href="#cb44-535" aria-hidden="true" tabindex="-1"></a><span class="in">mean_age &lt;- mean(analysis_data$age)</span></span>
<span id="cb44-536"><a href="#cb44-536" aria-hidden="true" tabindex="-1"></a><span class="in">new_data$age_in_months &lt;- new_data$age_centered + mean_age</span></span>
<span id="cb44-537"><a href="#cb44-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-538"><a href="#cb44-538" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot</span></span>
<span id="cb44-539"><a href="#cb44-539" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(new_data, aes(x = age_in_months, y = predicted_prob)) +</span></span>
<span id="cb44-540"><a href="#cb44-540" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(size = 1, color = "blue") +</span></span>
<span id="cb44-541"><a href="#cb44-541" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Age (months)", </span></span>
<span id="cb44-542"><a href="#cb44-542" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "Probability of Approaching Confounded Toy",</span></span>
<span id="cb44-543"><a href="#cb44-543" aria-hidden="true" tabindex="-1"></a><span class="in">       title = "Predicted Probability by Age") +</span></span>
<span id="cb44-544"><a href="#cb44-544" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb44-545"><a href="#cb44-545" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_hline(yintercept = 0.5, linetype = "dashed", color = "darkgray") +</span></span>
<span id="cb44-546"><a href="#cb44-546" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(0, 1) +</span></span>
<span id="cb44-547"><a href="#cb44-547" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(24, 36, by = 2))</span></span>
<span id="cb44-548"><a href="#cb44-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-549"><a href="#cb44-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-550"><a href="#cb44-550" aria-hidden="true" tabindex="-1"></a><span class="fu">## 8. Extended Applications</span></span>
<span id="cb44-551"><a href="#cb44-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-552"><a href="#cb44-552" aria-hidden="true" tabindex="-1"></a>For more complex developmental data, we may need more sophisticated</span>
<span id="cb44-553"><a href="#cb44-553" aria-hidden="true" tabindex="-1"></a>models.</span>
<span id="cb44-554"><a href="#cb44-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-555"><a href="#cb44-555" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mixed-Effects Logistic Regression for Nested Data</span></span>
<span id="cb44-556"><a href="#cb44-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-557"><a href="#cb44-557" aria-hidden="true" tabindex="-1"></a>The models we've been using already incorporate random effects for</span>
<span id="cb44-558"><a href="#cb44-558" aria-hidden="true" tabindex="-1"></a>subjects. We can extend this to include random slopes when we have</span>
<span id="cb44-559"><a href="#cb44-559" aria-hidden="true" tabindex="-1"></a>strong theoretical reasons to believe that the effect of a predictor</span>
<span id="cb44-560"><a href="#cb44-560" aria-hidden="true" tabindex="-1"></a>varies across participants:</span>
<span id="cb44-561"><a href="#cb44-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-562"><a href="#cb44-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r random-slopes, eval=FALSE}</span></span>
<span id="cb44-563"><a href="#cb44-563" aria-hidden="true" tabindex="-1"></a><span class="in"># Random slopes model (if we had a time-varying predictor)</span></span>
<span id="cb44-564"><a href="#cb44-564" aria-hidden="true" tabindex="-1"></a><span class="in"># model_random_slopes &lt;- glmer(approached_confounded ~ age_centered + </span></span>
<span id="cb44-565"><a href="#cb44-565" aria-hidden="true" tabindex="-1"></a><span class="in">#                             (1 + time|subject_id), </span></span>
<span id="cb44-566"><a href="#cb44-566" aria-hidden="true" tabindex="-1"></a><span class="in">#                             family = binomial(link = "logit"), </span></span>
<span id="cb44-567"><a href="#cb44-567" aria-hidden="true" tabindex="-1"></a><span class="in">#                             data = analysis_data)</span></span>
<span id="cb44-568"><a href="#cb44-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-569"><a href="#cb44-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-570"><a href="#cb44-570" aria-hidden="true" tabindex="-1"></a><span class="fu">### Longitudinal Logistic Models</span></span>
<span id="cb44-571"><a href="#cb44-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-572"><a href="#cb44-572" aria-hidden="true" tabindex="-1"></a>For longitudinal data, we can include time as a predictor and account</span>
<span id="cb44-573"><a href="#cb44-573" aria-hidden="true" tabindex="-1"></a>for repeated measures:</span>
<span id="cb44-574"><a href="#cb44-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-575"><a href="#cb44-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r longitudinal, eval=FALSE}</span></span>
<span id="cb44-576"><a href="#cb44-576" aria-hidden="true" tabindex="-1"></a><span class="in"># Longitudinal model (if we had multiple time points)</span></span>
<span id="cb44-577"><a href="#cb44-577" aria-hidden="true" tabindex="-1"></a><span class="in"># model_longitudinal &lt;- glmer(approached_confounded ~ age_centered * time + </span></span>
<span id="cb44-578"><a href="#cb44-578" aria-hidden="true" tabindex="-1"></a><span class="in">#                            (time|subject_id), </span></span>
<span id="cb44-579"><a href="#cb44-579" aria-hidden="true" tabindex="-1"></a><span class="in">#                            family = binomial(link = "logit"), </span></span>
<span id="cb44-580"><a href="#cb44-580" aria-hidden="true" tabindex="-1"></a><span class="in">#                            data = analysis_data)</span></span>
<span id="cb44-581"><a href="#cb44-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-582"><a href="#cb44-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-583"><a href="#cb44-583" aria-hidden="true" tabindex="-1"></a><span class="fu">### Handling Age as a Continuous Predictor</span></span>
<span id="cb44-584"><a href="#cb44-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-585"><a href="#cb44-585" aria-hidden="true" tabindex="-1"></a>When working with age, we might want to test for non-linear effects:</span>
<span id="cb44-586"><a href="#cb44-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-587"><a href="#cb44-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r age-quadratic}</span></span>
<span id="cb44-588"><a href="#cb44-588" aria-hidden="true" tabindex="-1"></a><span class="in"># Create squared age term</span></span>
<span id="cb44-589"><a href="#cb44-589" aria-hidden="true" tabindex="-1"></a><span class="in">analysis_data$age_centered_squared &lt;- analysis_data$age_centered^2</span></span>
<span id="cb44-590"><a href="#cb44-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-591"><a href="#cb44-591" aria-hidden="true" tabindex="-1"></a><span class="in"># Model with quadratic age term</span></span>
<span id="cb44-592"><a href="#cb44-592" aria-hidden="true" tabindex="-1"></a><span class="in">model_age_quadratic &lt;- glmer(approach_confounded ~ age_centered + </span></span>
<span id="cb44-593"><a href="#cb44-593" aria-hidden="true" tabindex="-1"></a><span class="in">                            age_centered_squared + (1|subject_id), </span></span>
<span id="cb44-594"><a href="#cb44-594" aria-hidden="true" tabindex="-1"></a><span class="in">                            family = binomial(link = "logit"), </span></span>
<span id="cb44-595"><a href="#cb44-595" aria-hidden="true" tabindex="-1"></a><span class="in">                            data = analysis_data)</span></span>
<span id="cb44-596"><a href="#cb44-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-597"><a href="#cb44-597" aria-hidden="true" tabindex="-1"></a><span class="in">summary(model_age_quadratic)</span></span>
<span id="cb44-598"><a href="#cb44-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-599"><a href="#cb44-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-600"><a href="#cb44-600" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9. Troubleshooting Common Issues</span></span>
<span id="cb44-601"><a href="#cb44-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-602"><a href="#cb44-602" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sample Size Considerations</span></span>
<span id="cb44-603"><a href="#cb44-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-604"><a href="#cb44-604" aria-hidden="true" tabindex="-1"></a>A common rule of thumb is to have at least 10 events per predictor. We</span>
<span id="cb44-605"><a href="#cb44-605" aria-hidden="true" tabindex="-1"></a>can check this:</span>
<span id="cb44-606"><a href="#cb44-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-607"><a href="#cb44-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r check-events}</span></span>
<span id="cb44-608"><a href="#cb44-608" aria-hidden="true" tabindex="-1"></a><span class="in"># Check number of events (successes)</span></span>
<span id="cb44-609"><a href="#cb44-609" aria-hidden="true" tabindex="-1"></a><span class="in">sum(analysis_data$approach_confounded)</span></span>
<span id="cb44-610"><a href="#cb44-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-611"><a href="#cb44-611" aria-hidden="true" tabindex="-1"></a><span class="in"># Check events per variable (EPV) for model2 (or another model that exists)</span></span>
<span id="cb44-612"><a href="#cb44-612" aria-hidden="true" tabindex="-1"></a><span class="in">sum(analysis_data$approach_confounded) / length(fixef(model2))</span></span>
<span id="cb44-613"><a href="#cb44-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-614"><a href="#cb44-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-615"><a href="#cb44-615" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multicollinearity</span></span>
<span id="cb44-616"><a href="#cb44-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-617"><a href="#cb44-617" aria-hidden="true" tabindex="-1"></a>Multicollinearity can be assessed with variance inflation factors</span>
<span id="cb44-618"><a href="#cb44-618" aria-hidden="true" tabindex="-1"></a>(VIFs):</span>
<span id="cb44-619"><a href="#cb44-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-620"><a href="#cb44-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r check-vif}</span></span>
<span id="cb44-621"><a href="#cb44-621" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a linear model for VIF calculation</span></span>
<span id="cb44-622"><a href="#cb44-622" aria-hidden="true" tabindex="-1"></a><span class="in">model_lm &lt;- lm(as.numeric(approach_confounded) ~ age_centered, </span></span>
<span id="cb44-623"><a href="#cb44-623" aria-hidden="true" tabindex="-1"></a><span class="in">              data = analysis_data)</span></span>
<span id="cb44-624"><a href="#cb44-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-625"><a href="#cb44-625" aria-hidden="true" tabindex="-1"></a><span class="in"># Calculate VIFs (requires car package)</span></span>
<span id="cb44-626"><a href="#cb44-626" aria-hidden="true" tabindex="-1"></a><span class="in"># car::vif(model_lm)</span></span>
<span id="cb44-627"><a href="#cb44-627" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-628"><a href="#cb44-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-629"><a href="#cb44-629" aria-hidden="true" tabindex="-1"></a>VIF values above 5 or 10 indicate problematic multicollinearity.</span>
<span id="cb44-630"><a href="#cb44-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-631"><a href="#cb44-631" aria-hidden="true" tabindex="-1"></a><span class="fu">## 10. Summary and Best Practices</span></span>
<span id="cb44-632"><a href="#cb44-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-633"><a href="#cb44-633" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use Alternatives to Logistic Regression</span></span>
<span id="cb44-634"><a href="#cb44-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-635"><a href="#cb44-635" aria-hidden="true" tabindex="-1"></a>Consider alternatives when: - The outcome has more than two categories</span>
<span id="cb44-636"><a href="#cb44-636" aria-hidden="true" tabindex="-1"></a>(use multinomial or ordinal logistic regression) - The data shows</span>
<span id="cb44-637"><a href="#cb44-637" aria-hidden="true" tabindex="-1"></a>overdispersion (use quasi-binomial or negative binomial models) - The</span>
<span id="cb44-638"><a href="#cb44-638" aria-hidden="true" tabindex="-1"></a>relationship between predictors and log odds is non-linear (use</span>
<span id="cb44-639"><a href="#cb44-639" aria-hidden="true" tabindex="-1"></a>generalized additive models) - The sample size is very small (use exact</span>
<span id="cb44-640"><a href="#cb44-640" aria-hidden="true" tabindex="-1"></a>logistic regression)</span>
<span id="cb44-641"><a href="#cb44-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-642"><a href="#cb44-642" aria-hidden="true" tabindex="-1"></a><span class="fu">### Checklist for Reporting Logistic Regression</span></span>
<span id="cb44-643"><a href="#cb44-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-644"><a href="#cb44-644" aria-hidden="true" tabindex="-1"></a>When reporting results: 1. Describe the model specification (fixed</span>
<span id="cb44-645"><a href="#cb44-645" aria-hidden="true" tabindex="-1"></a>effects, random effects, link function) 2. Report coefficients and</span>
<span id="cb44-646"><a href="#cb44-646" aria-hidden="true" tabindex="-1"></a>standard errors or confidence intervals 3. Include odds ratios for</span>
<span id="cb44-647"><a href="#cb44-647" aria-hidden="true" tabindex="-1"></a>easier interpretation 4. Report model fit statistics (AIC, BIC, etc.) 5.</span>
<span id="cb44-648"><a href="#cb44-648" aria-hidden="true" tabindex="-1"></a>Describe classification performance if relevant (accuracy, sensitivity,</span>
<span id="cb44-649"><a href="#cb44-649" aria-hidden="true" tabindex="-1"></a>specificity) 6. Include visualizations of key effects 7. Discuss the</span>
<span id="cb44-650"><a href="#cb44-650" aria-hidden="true" tabindex="-1"></a>findings in the context of developmental theory</span>
<span id="cb44-651"><a href="#cb44-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-652"><a href="#cb44-652" aria-hidden="true" tabindex="-1"></a><span class="fu">### Final Thoughts</span></span>
<span id="cb44-653"><a href="#cb44-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-654"><a href="#cb44-654" aria-hidden="true" tabindex="-1"></a>Logistic regression is a powerful tool for analyzing binary outcomes in</span>
<span id="cb44-655"><a href="#cb44-655" aria-hidden="true" tabindex="-1"></a>developmental research. By properly specifying models, carefully</span>
<span id="cb44-656"><a href="#cb44-656" aria-hidden="true" tabindex="-1"></a>interpreting results, and effectively communicating findings,</span>
<span id="cb44-657"><a href="#cb44-657" aria-hidden="true" tabindex="-1"></a>researchers can gain valuable insights into developmental processes.</span>
<span id="cb44-658"><a href="#cb44-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-659"><a href="#cb44-659" aria-hidden="true" tabindex="-1"></a>The finding that toddlers systematically explore to discover their own</span>
<span id="cb44-660"><a href="#cb44-660" aria-hidden="true" tabindex="-1"></a>competence has important implications for theories of intrinsic</span>
<span id="cb44-661"><a href="#cb44-661" aria-hidden="true" tabindex="-1"></a>motivation and self-directed learning in early childhood. Understanding</span>
<span id="cb44-662"><a href="#cb44-662" aria-hidden="true" tabindex="-1"></a>how children become aware of and test their own abilities can help</span>
<span id="cb44-663"><a href="#cb44-663" aria-hidden="true" tabindex="-1"></a>parents and educators better support children's natural curiosity and</span>
<span id="cb44-664"><a href="#cb44-664" aria-hidden="true" tabindex="-1"></a>drive for mastery.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>